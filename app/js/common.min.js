$(function() {

    $('.par_ax').click(function () {
       $(this).slideToggle(500);
    });

    /*animate header form*/
    $('.head__form').addClass('translate_tariff');

    /*show & hide fixed nav menu*/
    $(window).scroll(function(){
        var winTop = $(window).scrollTop();
        if(winTop >= 300){
            $(".fix").addClass('menu_in animated fadeInDown').removeClass('fadeOutUp');
        }else{
            $(".fix").removeClass('fadeInDown').addClass('fadeOutUp');
        }
    });

    /*scale pictures in world company section*/
    $('.office__one').hover(function () {
        $('.world__img_slider').toggleClass('scale_slider');
        $('.img_office').toggleClass('scale_world');
        $('.world__img_arr').toggleClass('hov_img_arr_1');
    });
    $('.office__two').hover(function () {
        $('.world__img_slider').toggleClass('scale_slider');
        $('.img_call').toggleClass('scale_world');
        $('.world__img_arr').toggleClass('hov_img_arr_2');
    });
    $('.office__three').hover(function () {
        $('.world__img_slider').toggleClass('scale_slider');
        $('.img_doc').toggleClass('scale_world');
        $('.world__img_arr').toggleClass('hov_img_arr_3');
    });

    /*form tel number mask*/
    $('.js_mask').mask('000-0000000');
    $('.js_mask_card').mask('0000-0000-0000-0000');
    $('.js_zeut_mask').mask('000000000');
    $('.js_cvv_mask').mask('000');

    /*push in modal button value*/
    $('a.js_value').click(function () {
        $('.form_id').val($(this).data("form"));
    });

    /*start & init parallax elements*/
    $(window).bind('scroll',function(e){
        parallaxScroll();
    });
    function parallaxScroll(){
        var scrolled = $(window).scrollTop();

        $('.pr_01').css('bottom',(40-(scrolled*.02))+'%');
        $('.pr_02').css('top',(10-(scrolled*.05))+'%');
        $('.pr_03').css('top',(25-(scrolled*.03))+'%');
        $('.pr_04').css('top',(80-(scrolled*.03))+'%');
        $('.pr_05').css('top',(80-(scrolled*.04))+'%');
        $('.pr_06').css('top',(95-(scrolled*.04))+'%');
        $('.pr_07').css('bottom',(50-(scrolled*.02))+'%');
        $('.pr_08').css('bottom',(25-(scrolled*.03))+'%');
        $('.pr_09').css('bottom',(85-(scrolled*.05))+'%');
        $('.pr_10').css('top',(40-(scrolled*.05))+'%');
        $('.pr_11').css('bottom',(38-(scrolled*.03))+'%');
        $('.pr_12').css('bottom',(15-(scrolled*.02))+'%');
        $('.world__circle__one').css('top',(500-(scrolled*.09))+'px');
        $('.world__circle__three').css('top',(650-(scrolled*.15))+'px');
        $('.world__circle__two').css('bottom',(800-(scrolled*.15))+'px');
    };
    /*end & init parallax elements*/

    /*START MOBILE BUTTONS AND MENU OPENS*/
    $('.mob_btn-def').click(function () {
        $('.btn_line').toggleClass('btn_open');
        $('.dt_mnu').slideToggle("fast");
    });
    $('.fix__mob-btn').click(function () {
        $('.btn_line').toggleClass('btn_open');
        $('.fix_mnu').slideToggle("fast");
    });
    /*END MOBILE BUTTONS AND MENU OPENS*/

    $('.dt_mnu a').click(function () {
        $('.dt_mnu').slideToggle('200');
        $('.btn_line').toggleClass('btn_open');
    });
    $('.fix_mnu a').click(function () {
        $('.fix_mnu').slideToggle('200');
        $('.btn_line').toggleClass('btn_open');
    });

    /*START FUNCTION TO ADD PROGRESS LINE TO NAVIGATION*/
    function scrollProgressLine() {
        var body = document.body;
        var html = document.documentElement;
        var viewportHeight = window.innerHeight;
        var documentHeight = Math.max( body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);
        var scrollTopValue = function () {
            return (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
        };
        window.addEventListener('scroll', function () {
            var scroll = scrollTopValue();
            var progress = (scroll / (documentHeight - viewportHeight))*100;
            var valueToSet = progress.toFixed(0);
            $('.fix__progress').width(valueToSet + '%');
        });
    };scrollProgressLine();
    /*END FUNCTION TO ADD PROGRESS LINE TO NAVIGATION*/
    $('input.js_hide_form').on( "click", function() {
        $('.js_hide_input').hide();
    });
    $('input.js_show_fields').on( "click", function() {
        $('.js_hide_input').show();
    });



});//END WINDOW FUNCTION
/*$('.footer__contacts h5').css('color','#fff');*/

$(function() {

    /*START TIMER*/
    /*set end date in countdown function and it will calculate time*/
    $('.time_go').countdown('2017/12/31 00:00:00', function(event) {
        $('.cou_hours').html(event.strftime('%H'));
        $('.cou_min').html(event.strftime('%M'));
        $('.cou_sec').html(event.strftime('%S'));
    });
    /*END TIMER*/

    /*start modal slider*/
    $('.js_mod_slider').on('afterChange', function(event, slick, currentSlide) {
        if (slick.$slides.length-1 == currentSlide) {
            $('.mod__next').hide();
            $('.mod_send').show();
        } else {
            $('.mod__next').show();
            $('.mod_send').hide();
        }
    });
    /*end modal slider*/

    /*START FADE TEXT SLIDER IN EQUIPMENT SECTION*/
    $('.js_text_sl').slick({
        dots: true,
        infinite: true,
        speed: 300,
        fade: true,
        cssEase: 'linear',
        arrows: false,
        autoplay: true,
        autoplaySpeed: 2500,
        dotsClass: 'dots_slider',
        pauseOnHover: true
    });
    /*END FADE TEXT SLIDER IN EQUIPMENT SECTION*/

    $('.js_world_slider').slick({
        dots: false,
        infinite: true,
        speed: 300,
        fade: true,
        cssEase: 'linear',
        arrows: false,
        autoplay: true,
        autoplaySpeed: 2500,
        pauseOnHover: false,
        adaptiveHeight: true
    });

    var timerClear;
    var closerClearTimer;
    var firstTimer;
    firstTimer = setTimeout(function(){
        $('.quest').addClass('quest__scaler').css('bottom','0');
        $('body').addClass('body_stop');
    }, 5000);

    $('.quest__closer').click(function () {
        $('.quest').removeClass('quest__scaler');
        $('body').removeClass('body_stop');
        clearTimeout(timerClear);
        closerClearTimer = setTimeout(function(){
            $('body').addClass('body_stop');
            $('.quest').addClass('quest__scaler');
        }, 180000);
    });
    $('.js_mod_slider').slick({
        dots: true,
        infinite: false,
        arrows: true,
        speed: 300,
        slidesToShow: 1,
        swipe: false,
        adaptiveHeight: true,
        dotsClass: 'mod__dots',
        prevArrow: $('.mod__prev'),
        nextArrow: $('.mod__next')
    });
    /*START POPUP MODAL FORM*/
    $('.popup_modal').magnificPopup({
        type: 'inline',
        fixedContentPos: true,
        closeBtnInside: false,
        showCloseBtn: false,
        preloader: false,
        midClick: true,
        removalDelay: 300,
        mainClass: 'my-mfp-slide-bottom',
        callbacks: {
            beforeOpen: function() {
                $('.quest').css('bottom','-110vh');
                clearTimeout(timerClear);
                clearTimeout(firstTimer);
                $('.js_mod_slider').slick('slickGoTo', 2);
                setTimeout(function () {
                    $('.js_mod_slider').slick('slickGoTo', 0);
                },300);
            },
            close: function() {
                $('.main-all-wrapper').removeClass('body_stop');
                $('.quest').removeClass('quest__scaler');
                clearTimeout(closerClearTimer);
               timerClear = setTimeout(function () {
                    $('.quest').css('bottom','0').addClass('quest__scaler');
                    $('body').addClass('body_stop');
                },50000);
            }
        }
    });
    //custom button closer
    $('.js_close_modal').on( "click", function() {
        $.magnificPopup.close();
    });
    /*END POPUP MODAL FORM*/


    $('.mod__btn').click(function() {
        $('.mod__step').find('input').each(function(){
           if ( $(this).val() === '') {
               $(this).prop('required',true);
               var slidenum = $(this).data('slide');
               $('.js_mod_slider').slick('slickGoTo', slidenum);
           }
        });
    });


});
$(function() {
    //E-mail Ajax Send
    $(".js_send_form").submit(function() { //Change
        var th = $(this);
        $.ajax({
            type: "POST",
            url: "mail.php", //Change
            data: th.serialize()
        }).done(function() {
            $.magnificPopup.close();
            $('.quest').removeClass('quest__scaler');
            $('body').removeClass('body_stop');
            setTimeout(function() {
                th.trigger("reset");
                $('.quest').hide();
                window.location.replace("http://maxtv.co.il/thanks.html");
            }, 50);
        });
        return false;
    });
    
    $('.quest__yellow-bg').click(function () {
        $('.quest').animate({
            scrollTop: $(".js-quest").offset().top
        }, 500);
        $('.js-quest').focus();
    });
    /*END FOCUS IN FORM ON CLICK*/

});

function scrollCanalAnimation() {
    var comma_separator_number_step = $.animateNumber.numberStepFactories.separator(' ');
    $(".number_count").each(function() {
        var tcount = $(this).data("count");
        $(this).animateNumber({ number: tcount,
                easing: 'linear',
                numberStep: comma_separator_number_step},
            1500);
    });
};

$('.box_tv_img').waypoint(function(direction) {
    $('.wrap_box').toggleClass('active_box');
}, {
    offset: '60%'
});

$('.plans').waypoint(function(direction) {
    $('.plans').toggleClass('translate_tariff');
}, {
    offset: '70%'
});

$('.step_inner').waypoint(function(direction) {
    $('.step_inner').addClass('step_scale');
}, {
    offset: '88%'
});

$('.competitor').waypoint(function(direction) {
    $('.competitor').toggleClass('dif_scale');
}, {
    offset: '90%'
});

$('.ours').waypoint(function(direction) {
    $('.ours').toggleClass('dif_scale');
}, {
    offset: '90%'
});
$('.plans__circle').waypoint(function(direction) {
    scrollCanalAnimation();
}, {
    offset: '90%'
});

$('.come__grid').waypoint(function(direction) {
    $('.js_cube').addClass('js_anim_platform');
    $('.js_shadows').addClass('js_anim_shadow');
    new Vivus('path', {
        type: 'oneByOne',
        duration: 230,
        start: 'autostart',
        selfDestroy: true
    });
}, {
    offset: '90%'
});


function checkPosition() {
    if (window.matchMedia('(min-width: 1024px)').matches) {
        $('.js_one').waypoint(function(direction) {
            $(this.element).toggleClass('animated').toggleClass('fadeInUp');
        }, {
            offset: '97%'
        });

        $('.js_two').waypoint(function(direction) {
            $(this.element).toggleClass('animated').toggleClass('fadeInUp');
        }, {
            offset: '95%'
        });

        $('.js_tree').waypoint(function(direction) {
            $(this.element).toggleClass('animated').toggleClass('fadeInUp');
        }, {
            offset: '93%'
        });

        $('.js_four').waypoint(function(direction) {
            $(this.element).toggleClass('animated').toggleClass('fadeInUp');
        }, {
            offset: '80%'
        });
    }
};
checkPosition();

